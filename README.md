
# Projeto Spring Java



## Tecnologias utilizadas

<div style="display: inline_block">
  <img align="center" alt="Spring" src="https://img.shields.io/badge/Spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white" />
  <img align="center" alt="MySql" src="https://img.shields.io/badge/MySQL-00000F?style=for-the-badge&logo=mysql&logoColor=white" />
  <img align="center" alt="Java" src="https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=java&logoColor=white" />
  <img align="center" alt="Heroku" src="https://img.shields.io/badge/Heroku-430098?style=for-the-badge&logo=heroku&logoColor=white" />
</div>


## Heroku
- [Heroku](https://www.heroku.com/#)
- Dashboard
- Create new app
  - app name: java-spring-coursesb
  - região: United States
- Criar Banco postgres
  - Resources
  - Add-ons
  - heroku postgres
    - Free
    - provision
## Banco Postgres
- Banco: springboot-course
- docker run -d --name spring-postgresql -p 5432:5432 -e POSTGRES_PASSWORD=1234567 -e POSTGRES_DB=springboot-course postgres:12.11
- docker exec -it spring-postgresql bash
- psql -h localhost -U postgres -W
- \l
- \c springboot-course
- \d
## Container PGAdmin
- docker run --name spring-pgadmin -p 15432:80 -e PGADMIN_DEFAULT_EMAIL=postgres@email.com.br -e PGADMIN_DEFAULT_PASSWORD=1234567 -d dpage/pgadmin4
- [Acessar PGAdmin](http://localhost:15432)

## Backup pelo PGAdmin
- Seleciona o banco
- clica com botão direito
- backup
- escolhe a pasta para salva e nome do arquivo
- formato *Plain*
- encoding: *utf-8*
- Dump options
  - Only schema: *YES*
  - Blobs: *NO*
  - Do not save: *(ALL)*
  - verbose messages: *NO*
- Delete tudo antes do **CREATE**



## Scripts do banco
```
create database springboot-course;

\c springboot-course

create table tb_category (
    id int8 generated by default as identity,
    name varchar(255),
    primary key (id)
)
    
create table tb_order (
    id int8 generated by default as identity,
    moment timestamp,
    order_status int4,
    client_id int8,
    primary key (id)
)
    
create table tb_order_item (
    price float8,
    quantity int4,
    product_id int8 not null,
    order_id int8 not null,
    primary key (order_id, product_id)
)
    
create table tb_payment (
    moment timestamp,
    order_id int8 not null,
    primary key (order_id)
)

create table tb_product (
    id int8 generated by default as identity,
    description varchar(255),
    img_url varchar(255),
    name varchar(255),
    price float8,
    primary key (id)
)
    
create table tb_product_category (
    product_id int8 not null,
    category_id int8 not null,
    primary key (product_id, category_id)
)

create table tb_user (
    id int8 generated by default as identity,
    email varchar(255),
    name varchar(255),
    password varchar(255),
    phone varchar(255),
    primary key (id)
)
    
alter table if exists tb_order 
    add constraint FKi0x0rv7d65vsceuy33km9567n 
    foreign key (client_id) 
    references tb_user

alter table if exists tb_order_item 
    add constraint FK4h5xid5qehset7qwe5l9c997x 
    foreign key (product_id) 
    references tb_product

alter table if exists tb_order_item 
    add constraint FKgeobgl2xu916he8vhljktwxnx 
    foreign key (order_id) 
    references tb_order
    
alter table if exists tb_payment 
    add constraint FKokaf4il2cwit4h780c25dv04r 
    foreign key (order_id) 
    references tb_order

alter table if exists tb_product_category 
    add constraint FK5r4sbavb4nkd9xpl0f095qs2a 
    foreign key (category_id) 
    references tb_category

alter table if exists tb_product_category 
    add constraint FKgbof0jclmaf8wn2alsoexxq3u 
    foreign key (product_id) 
    references tb_product

```
 
## Depedencias
- [Spring JPA](https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-jpa)
- [Banco H2](https://mvnrepository.com/artifact/com.h2database/h2)

